/***********************************************************************
* FILENAME :        test_monmult.c       VERSION: 1.0
*
* DESCRIPTION :
*       Testing of monmult.c
*
*
* NOTES : 
* 
* AUTHOR :    mraes        START DATE :    25 Mar 16
*
*
*****/
#include <stdint.h>
#include <stdio.h>
#include "monmult.h"

// TESTVECTORS (LITTLE ENDIAN)
//uint8_t a[SIZE] = {0xA3,0x71,0x79,0x01,0xFC,0xF2,0x93,0xC7,0x1C,0x69,0x2D,0x67,0x38,0x2B,0x7C,0x1A,0x40,0x88,0xBA,0x9B,0x10,0x53,0x65,0xED,0xFE,0x39,0xB4,0x77,0x3B,0xC8,0x9B,0xB2,0xE4,0xB1,0xA3,0xC9,0xCD,0xC8,0xF2,0x69,0x01,0x91,0x87,0x67,0xAC,0x6E,0x56,0xF1,0x60,0xBF,0x1E,0x0F,0x53,0xA8,0xAF,0x40,0xDB,0x76,0xB2,0xEA,0x90,0xDD,0xFF,0x40,0x0C,0xD2,0x4D,0xDC,0x5E,0xB3,0xE7,0xFA,0xB4,0x53,0x5E,0x75,0x0B,0x91,0x92,0x14,0x7E,0xD8,0xB8,0xA7,0x05,0x95,0xD0,0x55,0x97,0x30,0x78,0x41,0x81,0xEF,0xC6,0x64,0x9F,0x4A,0x9C,0x4A,0x3A,0x0B,0xCA,0xD8,0x9C,0x1A,0x64,0xA7,0xA9,0x6E,0xC8,0x0A,0xE5,0xCE,0xE2,0x3B,0x73,0x8A,0xEF,0xF0,0xE4,0xA6,0x40,0x26,0xF3,0xD9,0x50,0x1F};

//uint8_t b[SIZE] = {0xBD,0xAA,0x18,0x4C,0xCD,0x5C,0x95,0x35,0x5B,0xA2,0x9D,0xC0,0xEB,0xE2,0x8A,0xC6,0xBF,0xDF,0xA1,0x88,0x1B,0x8C,0x58,0xE3,0xB0,0xD8,0xF8,0xC6,0xB6,0x01,0x96,0xE2,0xE0,0x52,0x01,0x0B,0x3A,0xFF,0x65,0x48,0xE0,0x67,0xCD,0x9E,0x1E,0x6A,0xA4,0xFC,0x04,0xC5,0x7B,0x1C,0xF0,0x2B,0xD1,0x4E,0x62,0xFB,0x36,0x68,0xB9,0x70,0xC8,0x98,0x0C,0x8A,0x65,0x3C,0xD1,0x15,0x2B,0x13,0xCA,0x5A,0xB7,0xBA,0xFC,0x15,0x37,0x11,0x6C,0xF3,0x93,0x85,0x9B,0x1E,0xE8,0x28,0x44,0x4B,0xFB,0x6A,0xFD,0xEC,0xC9,0xCB,0xC9,0x07,0x28,0x2B,0x96,0xE0,0xF9,0xA5,0x8C,0x35,0x62,0xCC,0xAB,0xB9,0xF3,0xA2,0xA9,0x4D,0x24,0x07,0x16,0x87,0xF4,0x31,0xBB,0xBC,0x6D,0x0A,0x88,0xE5,0x47,0x7D};

//uint8_t n[SIZE] = {0x0D,0xD5,0x0F,0x26,0x8F,0x95,0xAD,0x59,0x24,0xA0,0xDA,0x8F,0xAE,0x27,0x9F,0xD4,0x7A,0xE7,0x7E,0xBF,0xDF,0x2D,0x12,0xDA,0x43,0x14,0x0F,0x20,0xFA,0x90,0x46,0xD5,0x39,0xF1,0xAA,0x90,0x02,0xE4,0xDC,0xA3,0x9C,0xA4,0xF2,0xFF,0x30,0xC1,0x14,0x22,0x7E,0x11,0xE3,0x77,0x00,0x1A,0xAD,0x50,0xE1,0x7B,0x91,0x4A,0x92,0x08,0x65,0x20,0x75,0x68,0x74,0xB3,0x65,0xB0,0x0C,0xC6,0x8B,0xC9,0x10,0xEF,0xC4,0x4E,0x45,0xAD,0xFA,0xD2,0x4F,0x06,0xEC,0x29,0x5C,0xF3,0xAA,0x97,0x82,0x70,0xB8,0x44,0x06,0x86,0xE0,0x67,0xFC,0x70,0x79,0xA4,0xF0,0xB3,0x0B,0x48,0xCD,0xF0,0x6C,0x6F,0x0B,0x8B,0x25,0x67,0x46,0x8F,0xEC,0xA4,0xC1,0xE3,0x6A,0x47,0x0D,0xEB,0xA3,0x81,0xB5,0xBA};

uint8_t a[SIZE] = {0xDC,0x56,0x4C,0x7F,0x8B,0x22,0x61,0x44,0x8E,0x54,0x9B,0xC7,0x02,0xEA,0x0E,0xFD,0x12,0x9C,0x67,0x16,0x2E,0x12,0x87,0x71,0x7A,0x00,0x6B,0x06,0x2B,0x2C,0x92,0xEB,0x04,0x28,0x15,0xB8,0xFE,0xCF,0x13,0x25,0x62,0x88,0x57,0xD7,0x8D,0x28,0x2A,0xD0,0x30,0x7D,0x50,0x66,0x49,0x70,0xA8,0xF5,0x78,0x0B,0x5D,0xC8,0x13,0xDF,0x80,0x60,0xFA,0xCF,0x09,0x14,0x68,0x35,0xB8,0xD6,0xD4,0x4E,0x98,0x5C,0xB2,0x7B,0x74,0xF5,0x83,0x2A,0x4E,0x03,0xBB,0x30,0xA9,0x31,0xDC,0x28,0xB7,0x78,0xF5,0x81,0x32,0x10,0x6F,0x9D,0xE1,0x88,0xF2,0x48,0x15,0xF1,0x55,0x5D,0x88,0x9B,0x86,0x4D,0x3A,0xF1,0xBD,0xBA,0x70,0xAE,0x6B,0x35,0x4D,0x78,0x37,0xBA,0x4C,0xB7,0x31,0x4F,0x1B,0x89};
uint8_t b[SIZE] = {0xDC,0x56,0x4C,0x7F,0x8B,0x22,0x61,0x44,0x8E,0x54,0x9B,0xC7,0x02,0xEA,0x0E,0xFD,0x12,0x9C,0x67,0x16,0x2E,0x12,0x87,0x71,0x7A,0x00,0x6B,0x06,0x2B,0x2C,0x92,0xEB,0x04,0x28,0x15,0xB8,0xFE,0xCF,0x13,0x25,0x62,0x88,0x57,0xD7,0x8D,0x28,0x2A,0xD0,0x30,0x7D,0x50,0x66,0x49,0x70,0xA8,0xF5,0x78,0x0B,0x5D,0xC8,0x13,0xDF,0x80,0x60,0xFA,0xCF,0x09,0x14,0x68,0x35,0xB8,0xD6,0xD4,0x4E,0x98,0x5C,0xB2,0x7B,0x74,0xF5,0x83,0x2A,0x4E,0x03,0xBB,0x30,0xA9,0x31,0xDC,0x28,0xB7,0x78,0xF5,0x81,0x32,0x10,0x6F,0x9D,0xE1,0x88,0xF2,0x48,0x15,0xF1,0x55,0x5D,0x88,0x9B,0x86,0x4D,0x3A,0xF1,0xBD,0xBA,0x70,0xAE,0x6B,0x35,0x4D,0x78,0x37,0xBA,0x4C,0xB7,0x31,0x4F,0x1B,0x89};
uint8_t n[SIZE] = {0x31, 0x6F, 0x7A, 0xE6, 0xE5, 0xBC, 0x77, 0xA6, 0xF8, 0x66, 0x9E, 0x3B, 0x02, 0xF4, 0xDF, 0x32, 0xC8, 0xA7, 0xB9, 0x2A, 0x1E, 0xBC, 0x08, 0xBE, 0x86, 0x11, 0xDE, 0x2A, 0xCF, 0xE8, 0x88, 0x8E, 0x3B, 0x5C, 0x6A, 0x71, 0x47, 0x3C, 0x45, 0x05, 0x46, 0xE4, 0xAD, 0x93, 0x42, 0x1F, 0x77, 0xDC, 0x25, 0x97, 0x70, 0xE1, 0xB5, 0xEB, 0x89, 0x7F, 0xA9, 0x1E, 0x50, 0x1D, 0x33, 0x99, 0x3C, 0x09, 0x68, 0xE4, 0x1A, 0xCF, 0xB0, 0x1E, 0xBA, 0x56, 0x24, 0x7C, 0x8E, 0x35, 0x84, 0xE0, 0xAA, 0x2D, 0xEC, 0x58, 0xA0, 0x4D, 0x89, 0x8A, 0x02, 0x27, 0x38, 0x54, 0x2E, 0x4F, 0xB2, 0x96, 0xAB, 0x29, 0x01, 0x21, 0x07, 0xF9, 0x85, 0x01, 0x99, 0xE7, 0xFE, 0xF8, 0x9A, 0x19, 0x6D, 0x92, 0x87, 0x68, 0x0E, 0x45, 0xB0, 0xCF, 0xD9, 0x3D, 0xA5, 0x36, 0x2C, 0x98, 0xD3, 0x0E, 0xD6, 0xB4, 0xD3, 0xD1}; // modulus
// output
uint8_t result_mon_mul[SIZE];

int main() 
{
	signed int i;
	setup_monmult(n);
	montgomery_multiplication(result_mon_mul,a,b,n);
	printf("\nResult of monmult is:\n");
	for(i=0; i<SIZE; i++)
	{
		fprintf(stdout,"0x%02X,", result_mon_mul[i]);
	}
	printf("\n");
	printf("\nResult in Maple format (Big Endian) is:\n");
	for(i=SIZE-1; i>=0; i--)
	{
		fprintf(stdout,"%02X", result_mon_mul[i]);
	}	
	
	return 0;
}
